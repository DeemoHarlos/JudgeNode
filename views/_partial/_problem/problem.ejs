<link rel="stylesheet" type="text/css" href="/stylesheets/shThemeDefault.css" />
<div class="header">
	<h1 class='article-title'><%- pid + ". " + ttl %></h1>
    <h2>I'm a slow walker, but I never walk backwards. </h2>
</div>
<div class="content">

<div class="pure-menu pure-menu-horizontal">

<ul class="pure-menu-list">
<% if (uid != undefined) { %>
	<li class="pure-menu-item"><a class="pure-menu-link" href='/submissions?pid=<%- pid %>&uid=<%- uid %>'><%= __('My Status') %></a></li>
<% } %>
	<li class="pure-menu-item"><a class="pure-menu-link" href='/submissions?pid=<%- pid %>'><%= __('Status') %></a></li>
	<li class="pure-menu-item"><a class="pure-menu-link" href='/statistic/problem/<%- cid %>/<%- pid %>'><%= __('Statistics') %></a></li>
	<li class="pure-menu-item"><a class="pure-menu-link" href='/solution/problem/<%- pid %>'><%= __('Solution') %></a></li>
<% if (user["uid"] >= 0 && user["class"] == null) { %>
	<li class="pure-menu-item"><a class="pure-menu-link" href='/statistic/grade/problem/<%- cid %>/<%- pid %>'><%= __('Report') %></a></li>
	<li class="pure-menu-item"><a class="pure-menu-link" href='/admin/edit/problem/<%- pid %>'><%= __('Edit') %></a></li>
<% } %>
</ul>

</div>

<%- problem_content %>

<%
var judge_res = site.JUDGE.result_message,
    judge_lng = site.JUDGE.lang,
    judge_compiler_arg = site.JUDGE.compiler_arg;
var unitConvert = site.unitConvert;
%>
<div class="pure-g">
	<div class="pure-u-1 pure-u-lg-2-3">
	<h2 class="content-subhead">Submit</h2>
<% if( canSubmit ) { %>
	<form class="pure-form  pure-form-aligned" action="/submit" method="post" enctype="multipart/form-data" id="submit_form">
		<fieldset>
		<input name="cid" type="hidden" value="<%- cid %>">
		<input name="pid" type="hidden" value="<%- pid %>">
		<% if( psubmit.length === 0 ){ %>
			<div class="pure-control-group">
				<label for="lng"><%= __('Programming Language') %></label>
				<select name="lng">
				<% for( var i = 1 ; i < judge_lng.length ; i++ ) { %>
					<option value="<%- i %>" <%- (i == 1 )?"selected" : "" %>><%- judge_lng[i] %> (<%- judge_compiler_arg[i] %>) </option>
				<% } %>
				</select>
			</div>

			<div class="pure-control-group">
				<label for="lng"><%= __('Source Code') %></label>
				<input class="pure-input-1-2" name="code0" type="file">
			</div>

		<% } else { %>
			<% for( var i = 0 ; i < psubmit.length ; i++ ){ %>
				<div class="pure-control-group">
					<label for="code<%- i %>"><%- psubmit[i] %></label>
					<input class="pure-input-1-2" name="code<%- i %>" type="file">
				</div>
			<% } %>
		<% } %>
			<div class="pure-controls">
				<button type="submit" name="submit" id="submit" class="pure-button pure-button-primary"><%= __('Submit') %></button>
			</div>
		</fieldset>
	</form>

	<script>
	document.getElementById("submit_form").addEventListener("submit", function(event){
		var answer = confirm("Before you submit, you should make sure that the source code is correct.");
		if(!answer){ event.preventDefault(); }
	});
	</script>	
<% } else { %>
	<a class="button-success pure-button" href="/login"><i class="fa fa-sign-in"></i> <%= __('Login') %></a>
<% } %>
	</div>
	<div class="pure-u-1 pure-u-lg-1-3">
		<h2 class="content-subhead">Testdata Set</h2>
    	<div class="pure-menu">
		    <ul class="pure-menu-list">
	    	<% for (var i in testdata_config) { %>
	    		<% var testset = testdata_config[i]; %>
	    		<li class="pure-menu-item">
	    			<a href="<%- site.HOST.testdata %><%- pid %>/<%- testset[1][0] %>" class="pure-menu-link" style="padding: 0em 0.1em;">
	    			<%- __('Subtask') %> <%- (parseInt(i)) %> (<%- testset[0] %>%): <%- config.unitConvert('cpu', testset[1][2]*1024) %>, <%- config.unitConvert('mem', testset[1][3]) %>
	    			</a>
	    		</li>
	    	<% } %>
		    </ul>
		</div>
	</div>
</div>

<%- include('../_widget/disqus')  %>


</div>

<script src="/javascripts/clipboard/clipboard.min.js"></script>

<script>
new Clipboard(".fw-code-copy-button", {
  text: function(trigger) {
  	var $rows = $(trigger).next().find('.code').find('.line');
  	var rowDelim = '\n';
  	return '' + $rows.map(function(i, row) {
  		var $row = $(row);
  		return $row.text().replace(/\s/g, " ");
  	}).get().join(rowDelim);
  }
});
</script>